import{r as P,a as y,o as q,g as n,b as u,q as O,E as G,D as M,d as D,c as J,w as K,e as b,f as k,i as r,F as $,l as z,u as t,j as E,x as U,_ as Q}from"./index-6808ba74.js";import{m as F}from"./message-27522a78.js";import{g as X}from"./thesis-d36a44e4.js";import{P as Z}from"./index-eb0c4c8c.js";import{u as Y}from"./hooks-62a2627c.js";import{E as ee}from"./edit-pen-af58ba35.js";import{R as te}from"./refresh-74425c09.js";import"./epTheme-ce7d143e.js";function le(){const p=P(),m=y(["结合生产实际或经济建设","结合科研","结合实验室建设","教师自拟"]),v=y(["待审核","通过","驳回"]),s=P(!0),f=y({text:"正在加载第1页...",viewBox:"-10, -10, 50, 50",spinner:`
        <path class="path" d="
          M 30 15
          L 28 17
          M 25.61 25.61
          A 15 15, 0, 0, 1, 15 30
          A 15 15, 0, 1, 1, 27.99 7.5
          L 15 15
        " style="stroke-width: 4px; fill: rgba(0, 0, 0, 0)"/>
      `}),g=y({total:0,pageSize:10,currentPage:1,background:!0}),x=[{type:"selection",width:50,align:"left",hide:({checkList:e})=>!e.includes("勾选列")},{label:"序号",type:"index",width:70,hide:({checkList:e})=>!e.includes("序号列")},{label:"课题名称",prop:"title",minWidth:300},{label:"课题类型",minWidth:150,cellRenderer:e=>n(u("el-text"),null,{default:()=>[m[e.row.type]]})},{label:"课题简介",prop:"introduce",minWidth:400},{label:"指导教师",prop:"teacher",minWidth:100},{label:"可接收总人数",prop:"total",minWidth:120},{label:"已选人数",prop:"selected",minWidth:100},{label:"选题学生",prop:"student",minWidth:100},{label:"学号",prop:"studentNo",minWidth:100},{label:"课题状态",minWidth:100,cellRenderer:e=>n(u("el-tag"),{key:e.row.id,type:["warning","primary","danger"][e.row.status],class:"mx-1",effect:"light"},{default:()=>[v[e.row.status]]})},{label:"创建时间",minWidth:160,prop:"createTime",formatter:({createTime:e})=>O(e).format("YYYY-MM-DD HH:mm:ss")},{label:"操作",fixed:"right",width:100,slot:"operation"}];function C(e,L){G.confirm(`确认要 <strong>${L===1?"通过":"驳回"}</strong> <strong style='color:var(--el-color-primary)'>${e.teacher}</strong> 的 <strong style='color:var(--el-color-primary)'>
      ${e.title}</strong> 课题申请吗?`,"审核提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0,draggable:!0}).then(()=>{s.value=!0,setTimeout(()=>{const l=p.value.findIndex(S=>S.id===e.id);l!==-1&&p.value.splice(l,1),F("审核成功",{type:"success"}),s.value=!1},500)}).catch(()=>{})}function c(){f.text="正在加载...",s.value=!0,M(500).then(()=>{s.value=!1})}function w(e){f.text=`正在加载第${e}页...`,s.value=!0,M(500).then(()=>{s.value=!1})}function h(){s.value=!0,X().then(e=>{e.success?(p.value=e.data,g.total=e.data.length):F(e.message,{type:"error"})}).finally(()=>{setTimeout(()=>{s.value=!1},500)})}return q(()=>{h()}),{loading:s,loadingConfig:f,columns:x,dataList:p,typeList:m,statusList:v,pagination:g,onSearch:h,handleAudit:C,handleSizeChange:c,handleCurrentChange:w}}const ae={class:"main"},ne=D({name:"TopicAudit"}),oe=D({...ne,setup(p){const m=P(),{loading:v,loadingConfig:s,columns:f,dataList:g,typeList:x,statusList:C,pagination:c,onSearch:w,handleAudit:h,handleSizeChange:e,handleCurrentChange:L}=le(),l=y({title:"",type:null,teacher:"",status:null}),S=o=>{o&&o.resetFields()},T=J(()=>g.value?g.value.filter(o=>o.title?o.title.toString().toLowerCase().includes(l.title):!1).filter(o=>o.teacher?o.teacher.toString().toLowerCase().includes(l.teacher):!1).filter(o=>[0,1,2,3].includes(l.type)?o.type===l.type:!0).filter(o=>[0,1,2].includes(l.status)?o.status===l.status:!0):[]);return K(()=>{c.total=T.value.length}),(o,i)=>{const W=u("el-input"),_=u("el-form-item"),R=u("el-option"),B=u("el-select"),A=u("el-button"),H=u("el-form"),I=u("el-popconfirm"),N=u("pure-table");return b(),k("div",ae,[n(H,{ref_key:"formRef",ref:m,inline:!0,model:l,class:"bg-bg_color w-[99/100] pl-8 pt-4"},{default:r(()=>[n(_,{label:"课题名称：",prop:"title"},{default:r(()=>[n(W,{modelValue:l.title,"onUpdate:modelValue":i[0]||(i[0]=a=>l.title=a),placeholder:"请输入课题名称",clearable:"",class:"!w-[200px]"},null,8,["modelValue"])]),_:1}),n(_,{label:"课题类型：",prop:"type"},{default:r(()=>[n(B,{modelValue:l.type,"onUpdate:modelValue":i[1]||(i[1]=a=>l.type=a),placeholder:"请选择课题类型",clearable:"",class:"!w-[180px]"},{default:r(()=>[(b(!0),k($,null,z(t(x),(a,d)=>(b(),U(R,{key:d,label:a,value:d},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(_,{label:"指导教师：",prop:"teacher"},{default:r(()=>[n(W,{modelValue:l.teacher,"onUpdate:modelValue":i[2]||(i[2]=a=>l.teacher=a),placeholder:"请输入指导教师",clearable:"",class:"!w-[200px]"},null,8,["modelValue"])]),_:1}),n(_,{label:"课题状态：",prop:"status"},{default:r(()=>[n(B,{modelValue:l.status,"onUpdate:modelValue":i[3]||(i[3]=a=>l.status=a),placeholder:"请选择课题状态",clearable:"",class:"!w-[180px]"},{default:r(()=>[(b(!0),k($,null,z(t(C),(a,d)=>(b(),U(R,{key:d,label:a,value:d},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(_,null,{default:r(()=>[n(A,{icon:t(Y)(t(te)),onClick:i[4]||(i[4]=a=>S(m.value))},{default:r(()=>[E(" 重置 ")]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"]),n(t(Z),{title:"审核列表",onRefresh:t(w),class:"overflow-hidden"},{default:r(({size:a,checkList:d})=>[n(N,{border:"","align-whole":"center",showOverflowTooltip:"",loading:t(v),"loading-config":t(s),size:a,height:a==="small"?360:500,data:t(T).slice((t(c).currentPage-1)*t(c).pageSize,t(c).currentPage*t(c).pageSize),columns:t(f),checkList:d,pagination:t(c),paginationSmall:a==="small","header-cell-style":{background:"var(--el-table-row-hover-bg-color)",color:"var(--el-text-color-primary)"},onPageSizeChange:t(e),onPageCurrentChange:t(L)},{operation:r(({row:V})=>[n(I,{title:"审核提示!","confirm-button-text":"通过","cancel-button-text":"驳回","cancel-button-type":"danger",onConfirm:j=>t(h)(V,1),onCancel:j=>t(h)(V,2)},{reference:r(()=>[n(A,{class:"reset-margin",link:"",type:"primary",size:a,disabled:V.status!==0,icon:t(Y)(t(ee))},{default:r(()=>[E(" 审核 ")]),_:2},1032,["size","disabled","icon"])]),_:2},1032,["onConfirm","onCancel"])]),_:2},1032,["loading","loading-config","size","height","data","columns","checkList","pagination","paginationSmall","header-cell-style","onPageSizeChange","onPageCurrentChange"])]),_:1},8,["onRefresh"])])}}});const fe=Q(oe,[["__scopeId","data-v-bf8b37b3"]]);export{fe as default};
