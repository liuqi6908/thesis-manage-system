import{e as y,f as j,n as Z,d as K,r as m,$ as ce,c as ae,G as pe,o as Q,aH as me,b as d,g as e,i as o,v as fe,R as ge,u as s,ag as q,j as k,t as te,a4 as he,p as _e,m as ve,_ as oe,a as T,q as be,E as xe,D as ye,w as E,F as Y,l as G,x as J}from"./index-6808ba74.js";import{c as H,s as we}from"./system-07b1b9f3.js";import{u as U}from"./hooks-62a2627c.js";import{S as Ve,D as Ce}from"./search-a904193b.js";import{m as A}from"./message-27522a78.js";import{P as ke}from"./index-eb0c4c8c.js";import{D as Se}from"./delete-6d738bc7.js";import{E as Le}from"./edit-pen-af58ba35.js";import{R as $e}from"./refresh-74425c09.js";import{A as Ne}from"./add-circle-line-438b436c.js";import"./epTheme-ce7d143e.js";const Me={width:24,height:24,body:'<path fill="currentColor" d="M18.537 19.567A9.961 9.961 0 0 1 12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10c0 2.136-.67 4.116-1.81 5.74L17 12h3a8 8 0 1 0-2.46 5.772l.997 1.795Z"/>'},je=Me,Re={width:24,height:24,body:'<path fill="currentColor" d="M12 3c-1.1 0-2 .9-2 2s.9 2 2 2s2-.9 2-2s-.9-2-2-2Zm0 14c-1.1 0-2 .9-2 2s.9 2 2 2s2-.9 2-2s-.9-2-2-2Zm0-7c-1.1 0-2 .9-2 2s.9 2 2 2s2-.9 2-2s-.9-2-2-2Z"/>'},Ue=Re,Ze={width:24,height:24,body:'<path fill="currentColor" d="M2 20h20v2H2v-2Zm2-8h2v7H4v-7Zm5 0h2v7H9v-7Zm4 0h2v7h-2v-7Zm5 0h2v7h-2v-7ZM2 7l10-5l10 5v4H2V7Zm2 1.236V9h16v-.764l-8-4l-8 4ZM12 8a1 1 0 1 1 0-2a1 1 0 0 1 0 2Z"/>'},Ie=Ze,De={width:24,height:24,body:'<path fill="currentColor" d="M4 11.333L0 9l12-7l12 7v8.5h-2v-7.333l-2 1.166v6.678l-.223.275A9.983 9.983 0 0 1 12 22a9.983 9.983 0 0 1-7.777-3.714L4 18.011v-6.678ZM6 12.5v4.792A7.979 7.979 0 0 0 12 20a7.978 7.978 0 0 0 6-2.708V12.5L12 16l-6-3.5ZM3.97 9L12 13.685L20.03 9L12 4.315L3.97 9Z"/>'},ze=De,Oe={width:"32",height:"32",viewBox:"0 0 24 24"},Te=Z("path",{fill:"currentColor",d:"M22 4V2H2v2h9v14.17l-5.5-5.5-1.42 1.41L12 22l7.92-7.92-1.42-1.41-5.5 5.5V4h9Z"},null,-1),Ae=[Te];function Be(h,f){return y(),j("svg",Oe,Ae)}const Fe={render:Be},He={width:"32",height:"32",viewBox:"0 0 24 24"},Pe=Z("path",{fill:"currentColor",d:"M4 2H2v20h2v-9h14.17l-5.5 5.5 1.41 1.42L22 12l-7.92-7.92-1.41 1.42 5.5 5.5H4V2Z"},null,-1),We=[Pe];function qe(h,f){return y(),j("svg",He,We)}const Ee={render:qe},Ye=h=>(_e("data-v-46005486"),h=h(),ve(),h),Ge={class:"bg-bg_color flex flex-col"},Je={class:"flex items-center h-[34px]"},Ke=Ye(()=>Z("p",{class:"flex-1 ml-2 font-bold text-base truncate",title:"部门列表"}," 班级列表 ",-1)),Qe=K({__name:"tree",setup(h){const f=m(),S=m([]),_=m(!0),v=m(""),c=m({}),{proxy:x}=ce(),I={children:"children",label:"name"},R=ae(()=>["!h-[20px]","reset-margin","!text-gray-500","dark:!text-white","dark:hover:!text-primary"]),D=(i,u)=>i?u.name.includes(i):!0;function z(i){var a;const u=i.$treeNodeId;c.value[u]=(a=c.value[u])!=null&&a.highlight?Object.assign({id:u},c.value[u],{highlight:!1}):Object.assign({id:u},c.value[u],{highlight:!0}),Object.values(c.value).forEach(V=>{V.id!==u&&(V.highlight=!1)})}function L(i){_.value=i;const u=x.$refs.treeRef.store._getAllNodes();for(let a=0;a<u.length;a++)u[a].expanded=i}function t(){c.value={},v.value="",L(!0)}return pe(v,i=>{f.value.filter(i)}),Q(async()=>{const{data:i}=await H();S.value=me(i)}),(i,u)=>{const a=d("IconifyIconOffline"),V=d("el-icon"),P=d("el-input"),$=d("el-button"),C=d("el-dropdown-item"),N=d("el-dropdown-menu"),B=d("el-dropdown"),F=d("el-divider"),W=d("el-tree");return y(),j("div",Ge,[Z("div",Je,[Ke,e(P,{style:{flex:"2"},size:"small",modelValue:v.value,"onUpdate:modelValue":u[0]||(u[0]=w=>v.value=w),placeholder:"输入关键词检索",clearable:""},{suffix:o(()=>[e(V,{class:"el-input__icon"},{default:o(()=>[fe(e(a,{icon:s(Ve)},null,8,["icon"]),[[ge,v.value.length===0]])]),_:1})]),_:1},8,["modelValue"]),e(B,{"hide-on-click":!1},{dropdown:o(()=>[e(N,null,{default:o(()=>[e(C,null,{default:o(()=>[e($,{class:q(s(R)),link:"",type:"primary",icon:s(U)(_.value?s(Fe):s(Ee)),onClick:u[1]||(u[1]=w=>L(!_.value))},{default:o(()=>[k(te(_.value?"折叠全部":"展开全部"),1)]),_:1},8,["class","icon"])]),_:1}),e(C,null,{default:o(()=>[e($,{class:q(s(R)),link:"",type:"primary",icon:s(U)(s(je)),onClick:t},{default:o(()=>[k(" 重置状态 ")]),_:1},8,["class","icon"])]),_:1})]),_:1})]),default:o(()=>[e(a,{class:"w-[28px] cursor-pointer",width:"18px",icon:s(Ue)},null,8,["icon"])]),_:1})]),e(F),e(W,{ref_key:"treeRef",ref:f,class:"h-0 flex-1 overflow-auto",data:S.value,"node-key":"id",size:"small",indent:10,props:I,"default-expand-all":"","expand-on-click-node":!1,"filter-node-method":D,onNodeClick:z},{default:o(({node:w,data:r})=>{var n,g;return[Z("span",{class:q(["pr-1","rounded","flex","items-center","select-none",v.value.trim().length>0&&w.label.includes(v.value)&&"text-blue-500",(n=c.value[w.id])!=null&&n.highlight?"dark:text-primary":""]),style:he({background:(g=c.value[w.id])!=null&&g.highlight?"var(--el-color-primary-light-7)":"transparent"})},[e(a,{icon:r.type===1?s(Ie):r.type===2?s(ze):s(Ce)},null,8,["icon"]),k(" "+te(w.label),1)],6)]}),_:1},8,["data"])])}}});const Xe=oe(Qe,[["__scopeId","data-v-46005486"]]);function el(){const h=m(),f=m(!0),S=T({text:"正在加载第1页...",viewBox:"-10, -10, 50, 50",spinner:`
        <path class="path" d="
          M 30 15
          L 28 17
          M 25.61 25.61
          A 15 15, 0, 0, 1, 15 30
          A 15 15, 0, 1, 1, 27.99 7.5
          L 15 15
        " style="stroke-width: 4px; fill: rgba(0, 0, 0, 0)"/>
      `}),_=m({}),v=T({total:0,pageSize:10,currentPage:1,background:!0}),c=[{type:"selection",width:50,align:"left",hide:({checkList:t})=>!t.includes("勾选列")},{label:"序号",type:"index",width:70,hide:({checkList:t})=>!t.includes("序号列")},{label:"姓名",prop:"username",minWidth:100},{label:"学号",prop:"userNo",minWidth:100},{label:"性别",prop:"gender",minWidth:70},{label:"学院",prop:"college",minWidth:150},{label:"专业",prop:"major",minWidth:150},{label:"班级",prop:"class",minWidth:100},{label:"手机号",prop:"phone",minWidth:120},{label:"电子邮箱",prop:"email",minWidth:120},{label:"状态",minWidth:75,cellRenderer:t=>{var i;return e(d("el-switch"),{size:t.props.size==="small"?"small":"default",loading:(i=_.value[t.index])==null?void 0:i.loading,modelValue:t.row.status,"onUpdate:modelValue":u=>t.row.status=u,"active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用","inline-prompt":!0,onChange:()=>x(t)},null)}},{label:"创建时间",minWidth:160,prop:"createTime",formatter:({createTime:t})=>be(t).format("YYYY-MM-DD HH:mm:ss")},{label:"操作",fixed:"right",width:150,slot:"operation"}];function x({row:t,index:i}){xe.confirm(`确认要 <strong>${t.status===0?"禁用":"启用"}</strong><strong style='color:var(--el-color-primary)'>${t.username}</strong> 学生账号吗?`,"系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0,draggable:!0}).then(()=>{_.value[i]=Object.assign({},_.value[i],{loading:!0}),setTimeout(()=>{_.value[i]=Object.assign({},_.value[i],{loading:!1}),A("已成功修改账号状态",{type:"success"})},300)}).catch(()=>{t.status===0?t.status=1:t.status=0})}function I(t){}function R(t){const i=h.value.map(u=>u.id).indexOf(t.id);i>=0&&h.value.splice(i,1),A("删除成功",{type:"success"})}function D(t){}function z(t){S.text=`正在加载第${t}页...`,f.value=!0,ye(500).then(()=>{f.value=!1})}async function L(){f.value=!0,await we().then(t=>{t.success?(h.value=t.data,v.total=t.data.length):A(t.message,{type:"error"})}).finally(()=>{setTimeout(()=>{f.value=!1},500)})}return Q(()=>{L()}),{loading:f,loadingConfig:S,columns:c,dataList:h,pagination:v,onSearch:L,handleUpdate:I,handleDelete:R,handleSizeChange:D,handleCurrentChange:z}}const ll={class:"main"},tl={class:"flex-1 h-full overflow-auto ml-[15px]"},al=K({name:"StudentManagement"}),ol=K({...al,setup(h){const f=m(),{loading:S,loadingConfig:_,columns:v,dataList:c,pagination:x,onSearch:I,handleUpdate:R,handleDelete:D,handleSizeChange:z,handleCurrentChange:L}=el(),t=T({username:"",userNo:"",status:null}),i=r=>{r&&r.resetFields()},u=m(!1),a=T({college:null,major:null,class:null,username:"",userNo:"",gender:"",phone:"",email:""}),V=m(),P=T({college:[{required:!0,message:"请选择学院",trigger:"change"}],major:[{required:!0,message:"请选择专业",trigger:"change"}],class:[{required:!0,message:"请选择班级",trigger:"change"}],username:[{required:!0,message:"请输入姓名",trigger:"blur"}],userNo:[{required:!0,message:"请输入学号",trigger:"blur"}],gender:[{required:!0,message:"请选择性别",trigger:"change"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"}],email:[{required:!0,message:"请输入电子邮箱",trigger:"blur"}]}),$=m([]),C=m([]),N=m([]);Q(()=>{H({type:1}).then(r=>{r.success&&($.value=r.data)})});const B=ae(()=>c.value?c.value.filter(r=>r.username?r.username.toString().toLowerCase().includes(t.username):!1).filter(r=>r.userNo?r.userNo.toString().toLowerCase().includes(t.userNo):!1).filter(r=>t.status===0||t.status===1?r.status===t.status:!0):[]);E(()=>{x.total=B.value.length});function F(r){W(V.value),C.value=[],N.value=[],r?r():u.value=!1}const W=r=>{r&&r.resetFields()};E(()=>{a.major=null,a.college&&H({type:2,id:a.college}).then(r=>{r.success&&(C.value=r.data)})}),E(()=>{a.class=null,a.major&&H({type:3,id:a.major}).then(r=>{r.success&&(N.value=r.data)})});const w=r=>{r&&r.validate(n=>{if(n){if(c.value.map(g=>g.userNo).includes(a.userNo))return A("新增失败，该学生已存在",{grouping:!0,type:"error"});{const g=$.value.map(b=>b.id).indexOf(a.college),p=C.value.map(b=>b.id).indexOf(a.major),M=N.value.map(b=>b.id).indexOf(a.class);c.value.push({id:Math.max(...c.value.map(b=>b.id))+1,username:a.username,userNo:a.userNo,gender:a.gender,college:$.value[g].name,major:C.value[p].name,class:N.value[M].name,phone:a.phone,email:a.email,status:1,createTime:new Date().getTime()}),F(),A("新增成功",{grouping:!0,type:"success"})}}})};return(r,n)=>{const g=d("el-input"),p=d("el-form-item"),M=d("el-option"),b=d("el-select"),O=d("el-button"),X=d("el-form"),ne=d("el-popconfirm"),se=d("pure-table"),ee=d("el-radio"),re=d("el-radio-group"),ue=d("el-dialog");return y(),j("div",ll,[e(Xe,{class:"w-[17%] h-full min-w-[150px]"}),Z("div",tl,[e(X,{ref_key:"formRef",ref:f,inline:!0,model:t,class:"bg-bg_color w-[99/100] pl-8 pt-4"},{default:o(()=>[e(p,{label:"姓名：",prop:"username"},{default:o(()=>[e(g,{modelValue:t.username,"onUpdate:modelValue":n[0]||(n[0]=l=>t.username=l),placeholder:"请输入姓名",clearable:"",class:"!w-[200px]"},null,8,["modelValue"])]),_:1}),e(p,{label:"学号：",prop:"userNo"},{default:o(()=>[e(g,{modelValue:t.userNo,"onUpdate:modelValue":n[1]||(n[1]=l=>t.userNo=l),placeholder:"请输入学号",clearable:"",class:"!w-[200px]"},null,8,["modelValue"])]),_:1}),e(p,{label:"状态：",prop:"status"},{default:o(()=>[e(b,{modelValue:t.status,"onUpdate:modelValue":n[2]||(n[2]=l=>t.status=l),placeholder:"请选择状态",clearable:"",class:"!w-[180px]"},{default:o(()=>[e(M,{label:"启用",value:1}),e(M,{label:"禁用",value:0})]),_:1},8,["modelValue"])]),_:1}),e(p,null,{default:o(()=>[e(O,{icon:s(U)(s($e)),onClick:n[3]||(n[3]=l=>i(f.value))},{default:o(()=>[k(" 重置 ")]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"]),e(s(ke),{title:"学生列表",onRefresh:s(I),class:"overflow-hidden"},{buttons:o(()=>[e(O,{type:"primary",icon:s(U)(s(Ne)),onClick:n[4]||(n[4]=l=>u.value=!0)},{default:o(()=>[k(" 新增学生 ")]),_:1},8,["icon"])]),default:o(({size:l,checkList:ie})=>[e(se,{border:"","align-whole":"center",showOverflowTooltip:"",loading:s(S),"loading-config":s(_),size:l,height:l==="small"?360:500,data:s(B).slice((s(x).currentPage-1)*s(x).pageSize,s(x).currentPage*s(x).pageSize),columns:s(v),checkList:ie,pagination:s(x),paginationSmall:l==="small","header-cell-style":{background:"var(--el-table-row-hover-bg-color)",color:"var(--el-text-color-primary)"},onPageSizeChange:s(z),onPageCurrentChange:s(L)},{operation:o(({row:le})=>[e(O,{class:"reset-margin",link:"",type:"primary",size:l,icon:s(U)(s(Le)),onClick:de=>s(R)(le)},{default:o(()=>[k(" 修改 ")]),_:2},1032,["size","icon","onClick"]),e(ne,{title:"是否确认删除?",onConfirm:de=>s(D)(le)},{reference:o(()=>[e(O,{class:"reset-margin",link:"",type:"danger",size:l,icon:s(U)(s(Se))},{default:o(()=>[k(" 删除 ")]),_:2},1032,["size","icon"])]),_:2},1032,["onConfirm"])]),_:2},1032,["loading","loading-config","size","height","data","columns","checkList","pagination","paginationSmall","header-cell-style","onPageSizeChange","onPageCurrentChange"])]),_:1},8,["onRefresh"]),e(ue,{modelValue:u.value,"onUpdate:modelValue":n[14]||(n[14]=l=>u.value=l),title:"新增学生",width:"500px","destroy-on-close":!0,"before-close":F},{footer:o(()=>[e(O,{type:"primary",onClick:n[13]||(n[13]=l=>w(V.value))},{default:o(()=>[k(" 添加 ")]),_:1})]),default:o(()=>[e(X,{ref_key:"ruleFormRef",ref:V,model:a,rules:P,"label-width":"100px","status-icon":""},{default:o(()=>[e(p,{label:"学院",prop:"college"},{default:o(()=>[e(b,{modelValue:a.college,"onUpdate:modelValue":n[5]||(n[5]=l=>a.college=l),placeholder:"请选择学院",class:"w-full"},{default:o(()=>[(y(!0),j(Y,null,G($.value,l=>(y(),J(M,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"专业",prop:"major"},{default:o(()=>[e(b,{modelValue:a.major,"onUpdate:modelValue":n[6]||(n[6]=l=>a.major=l),placeholder:"请选择专业",class:"w-full"},{default:o(()=>[(y(!0),j(Y,null,G(C.value,l=>(y(),J(M,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"班级",prop:"class"},{default:o(()=>[e(b,{modelValue:a.class,"onUpdate:modelValue":n[7]||(n[7]=l=>a.class=l),placeholder:"请选择班级",class:"w-full"},{default:o(()=>[(y(!0),j(Y,null,G(N.value,l=>(y(),J(M,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"姓名",prop:"username"},{default:o(()=>[e(g,{modelValue:a.username,"onUpdate:modelValue":n[8]||(n[8]=l=>a.username=l)},null,8,["modelValue"])]),_:1}),e(p,{label:"学号",prop:"userNo"},{default:o(()=>[e(g,{modelValue:a.userNo,"onUpdate:modelValue":n[9]||(n[9]=l=>a.userNo=l)},null,8,["modelValue"])]),_:1}),e(p,{label:"性别",prop:"gender"},{default:o(()=>[e(re,{modelValue:a.gender,"onUpdate:modelValue":n[10]||(n[10]=l=>a.gender=l)},{default:o(()=>[e(ee,{label:"男"}),e(ee,{label:"女"})]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"手机号",prop:"phone"},{default:o(()=>[e(g,{modelValue:a.phone,"onUpdate:modelValue":n[11]||(n[11]=l=>a.phone=l)},null,8,["modelValue"])]),_:1}),e(p,{label:"电子邮箱",prop:"email"},{default:o(()=>[e(g,{modelValue:a.email,"onUpdate:modelValue":n[12]||(n[12]=l=>a.email=l)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])])}}});const hl=oe(ol,[["__scopeId","data-v-736e78ab"]]);export{hl as default};
