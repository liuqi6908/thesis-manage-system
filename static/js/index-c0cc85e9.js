import{r as b,a as L,o as ee,q as j,D as U,h as te,d as R,w as ae,b as o,s as le,e as r,f as m,g as n,i as a,u as e,v as ne,x as h,F as z,j as g,n as W,t as T,l as H,p as oe,m as re,y as se,z as I,_ as ie}from"./index-6808ba74.js";import{m as q}from"./message-27522a78.js";import{g as ce}from"./student-acb41f04.js";import{P as de}from"./index-eb0c4c8c.js";import"./epTheme-ce7d143e.js";function ue(){const s=b(),v=b(),i=b(!0),_=L({text:"正在加载第1页...",viewBox:"-10, -10, 50, 50",spinner:`
        <path class="path" d="
          M 30 15
          L 28 17
          M 25.61 25.61
          A 15 15, 0, 0, 1, 15 30
          A 15 15, 0, 1, 1, 27.99 7.5
          L 15 15
        " style="stroke-width: 4px; fill: rgba(0, 0, 0, 0)"/>
      `}),y=L({total:0,pageSize:10,currentPage:1,background:!0}),d=[{type:"selection",width:45,align:"left",hide:({checkList:t})=>!t.includes("勾选列")},{label:"序号",type:"index",width:70,hide:({checkList:t})=>!t.includes("序号列")},{label:"姓名",prop:"username",minWidth:90},{label:"学院",prop:"college",minWidth:120},{label:"专业",prop:"major",minWidth:150},{label:"班级",prop:"class",minWidth:90},{label:"学号",prop:"userNo",minWidth:90},{label:"课题名称",prop:"title",minWidth:220},{label:"创建时间",minWidth:160,prop:"createTime",formatter:({createTime:t})=>j(t).format("YYYY-MM-DD HH:mm:ss")}];function u(){_.text="正在加载...",i.value=!0,U(500).then(()=>{i.value=!1})}function P(t){_.text=`正在加载第${t}页...`,i.value=!0,U(500).then(()=>{i.value=!1})}function M(t){v.value=t}function C(){i.value=!0,ce({status:1}).then(t=>{t.success?(s.value=t.data,y.total=t.data.length):q(t.message,{type:"error"})}).finally(()=>{setTimeout(()=>{i.value=!1},500)})}return ee(()=>{C()}),{dataList:s,loading:i,loadingConfig:_,columns:d,pagination:y,multipleSelection:v,onSearch:C,handleSizeChange:u,handleCurrentChange:P,handleSelectionChange:M}}const pe=s=>te.request("post","/teacherGetTopicData",{data:s}),_e=s=>(oe("data-v-82b567b8"),s=s(),re(),s),fe={class:"main"},me=_e(()=>W("div",{class:"card-header"},[W("span",{class:"font-bold"},"过程资料")],-1)),he={class:"text-blue-600"},ge={key:0},be=R({name:"DataManagement"}),ve=R({...be,setup(s){const{dataList:v,loading:i,loadingConfig:_,columns:y,pagination:d,multipleSelection:u,onSearch:P,handleSizeChange:M,handleCurrentChange:C,handleSelectionChange:t}=ue(),k=b([]),N=b(!1),S=L(["开题报告","任务书","论文定稿","论文成绩考核表"]);ae(()=>{var V,Y;(V=u.value)!=null&&V.title&&(N.value=!0,pe({title:(Y=u.value)==null?void 0:Y.title}).then(c=>{c.success&&(k.value=c.data||[])}).finally(()=>{for(let c=0;c<S.length;c++)k.value.find(x=>x.name==S[c])||k.value.push({name:S[c],fileName:null,fileUrl:null,feedback:null,username:null,createTime:null});setTimeout(()=>{N.value=!1},1e3)}))});function A(){q("上传失败，服务器错误，请稍后再试！",{type:"error",grouping:!0})}return(V,Y)=>{const c=o("pure-table"),x=o("el-button"),E=o("el-upload"),f=o("el-descriptions-item"),F=o("el-link"),G=o("el-input"),O=o("el-descriptions"),$=o("el-tab-pane"),J=o("el-tabs"),K=o("el-empty"),Q=o("el-card"),X=le("loading");return r(),m("div",fe,[n(e(de),{title:"课题列表（请选择一行）",onRefresh:e(P),class:"overflow-hidden"},{default:a(({size:p,checkList:w})=>{var D;return[n(c,{ref:"tableRef",border:"","align-whole":"center",showOverflowTooltip:"","highlight-current-row":"",loading:e(i),"loading-config":e(_),size:p,height:p==="small"?130:160,data:(D=e(v))==null?void 0:D.slice((e(d).currentPage-1)*e(d).pageSize,e(d).currentPage*e(d).pageSize),columns:e(y),checkList:w,pagination:e(d),paginationSmall:p==="small","header-cell-style":{background:"var(--el-table-row-hover-bg-color)",color:"var(--el-text-color-primary)"},"row-style":{cursor:"pointer"},onPageSizeChange:e(M),onPageCurrentChange:e(C),onCurrentChange:e(t)},null,8,["loading","loading-config","size","height","data","columns","checkList","pagination","paginationSmall","header-cell-style","onPageSizeChange","onPageCurrentChange","onCurrentChange"])]}),_:1},8,["onRefresh"]),ne((r(),h(Q,{class:"box-card mt-6",shadow:"never"},{header:a(()=>[me]),default:a(()=>{var p;return[(p=e(u))!=null&&p.id?(r(),m(z,{key:0},[g(" 课题名称："),W("span",he,T(e(u).title),1),n(J,{type:"border-card",class:"mt-4"},{default:a(()=>[(r(!0),m(z,null,H(S,(w,D)=>(r(),h($,{key:D,label:w},{default:a(()=>{var B;return[(r(!0),m(z,null,H((B=k.value)==null?void 0:B.filter(l=>l.name===w),l=>(r(),h(O,{border:"",column:2,key:l.name},{default:a(()=>[n(f,{label:"上传资料"},{default:a(()=>[n(E,{ref_for:!0,ref:"upload",action:"https://run.mocky.io/v3/9d059bf9-4660-45f2-925d-ce80ad6c4d15",limit:1,"auto-upload":!1},{trigger:a(()=>[n(x,{type:"primary",icon:e(se)},{default:a(()=>[g(" 选择文件 ")]),_:1},8,["icon"])]),default:a(()=>[n(x,{class:"ml-3",type:"success",onClick:A},{default:a(()=>[g(" 上传 ")]),_:1})]),_:1},512)]),_:1}),n(f,{label:"下载资料"},{default:a(()=>[l.fileName&&l.fileUrl?(r(),h(F,{key:0,type:"primary",href:l.fileUrl,target:"_blank"},{default:a(()=>[g(T(l.fileName),1)]),_:2},1032,["href"])):I("",!0)]),_:2},1024),n(f,{label:"上传者"},{default:a(()=>[g(T(l.username),1)]),_:2},1024),n(f,{label:"上传时间"},{default:a(()=>[l.createTime?(r(),m("span",ge,T(e(j)(l.createTime).format("YYYY-MM-DD HH:mm:ss")),1)):I("",!0)]),_:2},1024),n(f,{label:"指导教师意见"},{default:a(()=>[n(G,{type:"textarea",modelValue:l.feedback,"onUpdate:modelValue":Z=>l.feedback=Z,placeholder:"请输入指导教师意见",readonly:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]}),_:2},1032,["label"]))),128))]),_:1})],64)):(r(),h(K,{key:1,description:"请选择一项课题"}))]}),_:1})),[[X,N.value]])])}}});const we=ie(ve,[["__scopeId","data-v-82b567b8"]]);export{we as default};
